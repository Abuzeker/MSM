{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/tzika/Desktop/Polymerlink-Front/polymerlink-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"C:/Users/tzika/Desktop/Polymerlink-Front/polymerlink-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"C:/Users/tzika/Desktop/Polymerlink-Front/polymerlink-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/tzika/Desktop/Polymerlink-Front/polymerlink-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"C:/Users/tzika/Desktop/Polymerlink-Front/polymerlink-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _objectWithoutProperties from\"C:/Users/tzika/Desktop/Polymerlink-Front/polymerlink-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";var _excluded=[\"editing\",\"dataIndex\",\"title\",\"inputType\",\"record\",\"index\",\"children\"];import React,{useEffect,useState}from'react';import{Table,Input,InputNumber,Popconfirm,Form,Typography,Card,Switch,Button}from'antd';import{RealtimeData_Request,write_setting}from'../../../api';import{DataSortST}from'../../../DataRequest/RealTimeRequestWrap';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ValueSetting=[];var Blankpage;var EditableCell=function EditableCell(_ref){var editing=_ref.editing,dataIndex=_ref.dataIndex,title=_ref.title,inputType=_ref.inputType,record=_ref.record,index=_ref.index,children=_ref.children,restProps=_objectWithoutProperties(_ref,_excluded);var inputNode=inputType==='number'?/*#__PURE__*/_jsx(InputNumber,{}):/*#__PURE__*/_jsx(Switch,{defaultChecked:!record});return/*#__PURE__*/_jsx(\"td\",_objectSpread(_objectSpread({},restProps),{},{children:editing?inputType==='number'?/*#__PURE__*/_jsx(Form.Item,{name:dataIndex,style:{margin:0},rules:[{required:true,message:\"Please Input \".concat(title,\"!\")}],children:inputNode}):/*#__PURE__*/_jsx(Form.Item,{valuePropName:\"checked\",name:dataIndex,style:{margin:0},rules:[{required:true,message:\"Please Input \".concat(title,\"!\")}],children:inputNode}):children}));};var NotificationG2=function NotificationG2(){var _Form$useForm=Form.useForm(),_Form$useForm2=_slicedToArray(_Form$useForm,1),form=_Form$useForm2[0];var _useState=useState(''),_useState2=_slicedToArray(_useState,2),editingKey=_useState2[0],setEditingKey=_useState2[1];var _useState3=useState({count:0,count2:100}),_useState4=_slicedToArray(_useState3,2),state=_useState4[0],setState=_useState4[1];var isEditing=function isEditing(record){return record.key===editingKey;};var edit=function edit(record){console.log(record);form.setFieldsValue(_objectSpread({},record));setEditingKey(record.key);};var cancel=function cancel(){setEditingKey('');};var save=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(key){var row,newData,index,item;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return form.validateFields();case 3:row=_context.sent;newData=_toConsumableArray(ValueSetting);index=newData.findIndex(function(item){return key===item.key;});if(index>-1){item=newData[index];newData.splice(index,1,_objectSpread(_objectSpread({},item),row));// setData(newData);\nValueSetting=newData;setEditingKey('');}else{newData.push(row);ValueSetting=newData;setEditingKey('');}setState(function(_ref3){var count=_ref3.count;return{count:count+1};});_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);console.log('Validate Failed:',_context.t0);case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return function save(_x){return _ref2.apply(this,arguments);};}();var columns=[{title:'Site',dataIndex:'Line',width:'15%',align:'center',editable:false},{title:'Parameter',dataIndex:'Parameter',width:'25%',align:'center',editable:false},{title:'Upper Threshold',dataIndex:'HighThreshold',width:'15%',align:'center',editable:true},{title:'Activation',dataIndex:'HighThreshold_active',width:'10%',align:'center',editable:true,render:function render(record){return/*#__PURE__*/_jsx(Switch,{checked:record,disabled:isEditing});}},{title:'Lower Threshold',dataIndex:'LowThreshold',width:'15%',align:'center',editable:true},{title:'Activation',dataIndex:'LowThreshold_active',width:'10%',align:'center',editable:true,render:function render(record){return/*#__PURE__*/ (// SelectorHandler(record)\n_jsx(Switch,{checked:record,disabled:isEditing}));}},{title:'Operation',dataIndex:'operation',width:'20%',render:function render(_,record){var editable=isEditing(record);return editable?/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"a\",{href:\"javascript:;\",onClick:function onClick(){return save(record.key);},style:{marginRight:8},children:\"Save\"}),/*#__PURE__*/_jsx(Popconfirm,{title:\"Sure to cancel?\",onConfirm:cancel,children:/*#__PURE__*/_jsx(\"a\",{children:\"Cancel\"})})]}):/*#__PURE__*/_jsx(Typography.Link,{disabled:editingKey!=='',onClick:function onClick(){return edit(record);},children:\"Edit\"});}}];var mergedColumns=columns.map(function(col){if(!col.editable){return col;}return _objectSpread(_objectSpread({},col),{},{onCell:function onCell(record){return{record:record,inputType:col.title==='Activation'?'checked':'number',dataIndex:col.dataIndex,title:col.title,editing:isEditing(record)};}});});var DataRequest=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(label,site,page,line){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return RealtimeData_Request(label,site,page,line);case 2:response=_context2.sent;ValueSetting=DataSortST(response);console.log(ValueSetting);setState(function(_ref5){var count=_ref5.count;return{count:count+1};});case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function DataRequest(_x2,_x3,_x4,_x5){return _ref4.apply(this,arguments);};}();var RenderNewData=function RenderNewData(){DataRequest([],'Polymerlink',Blankpage,'G2');};useEffect(function(){RenderNewData();return function(){console.log(\"unmount\");};},[]);var SettingSavehandler=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var WriteStatus;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:console.log(ValueSetting);_context3.next=3;return write_setting(ValueSetting,'G2');case 3:WriteStatus=_context3.sent;console.log(WriteStatus);if(WriteStatus[\"success\"]===true){console.log('success');RenderNewData();}else{console.log('fail');}console.log(ValueSetting);case 7:case\"end\":return _context3.stop();}}},_callee3);}));return function SettingSavehandler(){return _ref6.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'20px'},children:/*#__PURE__*/_jsxs(Card,{title:\"G2 Notification Setting\",bordered:true,style:{width:'100%',borderRadius:15,backgroundColor:'#c4c4c4'},bodyStyle:{backgroundColor:'#575757',borderBottomLeftRadius:15,borderBottomRightRadius:15},hoverable:true,children:[/*#__PURE__*/_jsx(Button,{onClick:SettingSavehandler,style:{marginBottom:'8px'},children:\" Save \"}),/*#__PURE__*/_jsx(Form,{form:form,component:false,children:/*#__PURE__*/_jsx(Table,{components:{body:{cell:EditableCell}},bordered:true,scroll:{x:500,y:800},dataSource:ValueSetting,columns:mergedColumns,rowClassName:\"editable-row\",pagination:false})})]})});};export default NotificationG2;","map":{"version":3,"sources":["C:/Users/tzika/Desktop/Polymerlink-Front/polymerlink-2/src/pages/Line1/Notification/NotificationG2.jsx"],"names":["React","useEffect","useState","Table","Input","InputNumber","Popconfirm","Form","Typography","Card","Switch","Button","RealtimeData_Request","write_setting","DataSortST","ValueSetting","Blankpage","EditableCell","editing","dataIndex","title","inputType","record","index","children","restProps","inputNode","margin","required","message","NotificationG2","useForm","form","editingKey","setEditingKey","count","count2","state","setState","isEditing","key","edit","console","log","setFieldsValue","cancel","save","validateFields","row","newData","findIndex","item","splice","push","columns","width","align","editable","render","_","marginRight","mergedColumns","map","col","onCell","DataRequest","label","site","page","line","response","RenderNewData","SettingSavehandler","WriteStatus","marginTop","borderRadius","backgroundColor","borderBottomLeftRadius","borderBottomRightRadius","marginBottom","body","cell","x","y"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Table, Input, InputNumber, Popconfirm, Form, Typography, Card, Switch, Button } from 'antd';\r\nimport { RealtimeData_Request, write_setting } from '../../../api';\r\nimport { DataSortST } from '../../../DataRequest/RealTimeRequestWrap';\r\n\r\nlet ValueSetting = []\r\nlet Blankpage\r\n\r\n\r\nconst EditableCell = ({\r\n    editing,\r\n    dataIndex,\r\n    title,\r\n    inputType,\r\n    record,\r\n    index,\r\n    children,\r\n    ...restProps\r\n}) => {\r\n\r\n    const inputNode = inputType === 'number' ? <InputNumber /> : <Switch defaultChecked={!record} />;\r\n    return (\r\n        <td {...restProps}>\r\n            {editing ? (\r\n\r\n                inputType === 'number' ?\r\n                    (<Form.Item\r\n\r\n                        name={dataIndex}\r\n                        style={{\r\n                            margin: 0,\r\n                        }}\r\n                        rules={[\r\n                            {\r\n                                required: true,\r\n                                message: `Please Input ${title}!`,\r\n                            },\r\n                        ]}\r\n                    >\r\n                        {inputNode}\r\n                    </Form.Item>) :\r\n                    (<Form.Item\r\n                        valuePropName=\"checked\"\r\n                        name={dataIndex}\r\n                        style={{\r\n                            margin: 0,\r\n                        }}\r\n                        rules={[\r\n                            {\r\n                                required: true,\r\n                                message: `Please Input ${title}!`,\r\n                            },\r\n                        ]}\r\n                    >\r\n                        {inputNode}\r\n                    </Form.Item>)\r\n            ) : (\r\n                children\r\n            )}\r\n        </td>\r\n    );\r\n};\r\n\r\nconst NotificationG2 = () => {\r\n    const [form] = Form.useForm()\r\n    const [editingKey, setEditingKey] = useState('')\r\n    const [state, setState] = useState({ count: 0, count2: 100 });\r\n\r\n\r\n    const isEditing = (record) => record.key === editingKey;\r\n\r\n\r\n    const edit = (record) => {\r\n        console.log(record)\r\n        form.setFieldsValue({\r\n            ...record,\r\n        });\r\n        setEditingKey(record.key);\r\n    };\r\n\r\n    const cancel = () => {\r\n        setEditingKey('');\r\n    };\r\n\r\n    const save = async (key) => {\r\n        try {\r\n            const row = await form.validateFields();\r\n            const newData = [...ValueSetting];\r\n            const index = newData.findIndex((item) => key === item.key);\r\n\r\n            if (index > -1) {\r\n                const item = newData[index];\r\n                newData.splice(index, 1, { ...item, ...row });\r\n                // setData(newData);\r\n                ValueSetting = newData\r\n                setEditingKey('');\r\n            } else {\r\n                newData.push(row);\r\n                ValueSetting = newData\r\n                setEditingKey('');\r\n            }\r\n            setState(({ count }) => ({ count: count + 1 }));\r\n\r\n        } catch (errInfo) {\r\n            console.log('Validate Failed:', errInfo);\r\n        }\r\n    };\r\n\r\n    const columns = [\r\n        {\r\n            title: 'Site',\r\n            dataIndex: 'Line',\r\n            width: '15%',\r\n            align: 'center',\r\n            editable: false,\r\n        },\r\n        {\r\n            title: 'Parameter',\r\n            dataIndex: 'Parameter',\r\n            width: '25%',\r\n            align: 'center',\r\n            editable: false,\r\n        },\r\n\r\n        {\r\n            title: 'Upper Threshold',\r\n            dataIndex: 'HighThreshold',\r\n            width: '15%',\r\n            align: 'center',\r\n            editable: true,\r\n        },\r\n        {\r\n            title: 'Activation',\r\n            dataIndex: 'HighThreshold_active',\r\n            width: '10%',\r\n            align: 'center',\r\n            editable: true,\r\n            render: (record) => {\r\n                return (\r\n                    <Switch checked={record} disabled={isEditing} />\r\n                )\r\n            }\r\n        },\r\n\r\n        {\r\n            title: 'Lower Threshold',\r\n            dataIndex: 'LowThreshold',\r\n            width: '15%',\r\n            align: 'center',\r\n            editable: true,\r\n        },\r\n        {\r\n            title: 'Activation',\r\n            dataIndex: 'LowThreshold_active',\r\n            width: '10%',\r\n            align: 'center',\r\n            editable: true,\r\n            render: (record) => {\r\n                return (\r\n                    // SelectorHandler(record)\r\n                    <Switch checked={record} disabled={isEditing} />\r\n                )\r\n            }\r\n        },\r\n\r\n        {\r\n            title: 'Operation',\r\n            dataIndex: 'operation',\r\n            width: '20%',\r\n            render: (_, record) => {\r\n                const editable = isEditing(record);\r\n                return editable ? (\r\n                    <span>\r\n                        <a\r\n                            href=\"javascript:;\"\r\n                            onClick={() => save(record.key)}\r\n                            style={{\r\n                                marginRight: 8,\r\n                            }}\r\n                        >\r\n                            Save\r\n                        </a>\r\n                        <Popconfirm title=\"Sure to cancel?\" onConfirm={cancel}>\r\n                            <a>Cancel</a>\r\n                        </Popconfirm>\r\n                    </span>\r\n                ) : (\r\n                    <Typography.Link disabled={editingKey !== ''} onClick={() => edit(record)}>\r\n                        Edit\r\n                    </Typography.Link>\r\n                );\r\n            },\r\n        },\r\n    ];\r\n\r\n    const mergedColumns = columns.map((col) => {\r\n        if (!col.editable) {\r\n            return col;\r\n        }\r\n\r\n        return {\r\n            ...col,\r\n            onCell: (record) => ({\r\n                record,\r\n                inputType: col.title === 'Activation' ? 'checked' : 'number',\r\n                dataIndex: col.dataIndex,\r\n                title: col.title,\r\n                editing: isEditing(record),\r\n            }),\r\n        };\r\n    });\r\n\r\n    const DataRequest = async (label, site, page, line) => {\r\n        const response = await RealtimeData_Request(label, site, page, line)\r\n        ValueSetting = DataSortST(response)\r\n        console.log(ValueSetting);\r\n        setState(({ count }) => ({ count: count + 1 }));\r\n\r\n    }\r\n\r\n\r\n    const RenderNewData = () => {\r\n        DataRequest([], 'Polymerlink', Blankpage , 'G2')\r\n    }\r\n\r\n    useEffect(() => {\r\n        RenderNewData()\r\n        return () => {\r\n            console.log(\"unmount\");\r\n        }\r\n\r\n    }, []);\r\n\r\n    const SettingSavehandler = async () => {\r\n        console.log(ValueSetting);\r\n        const WriteStatus = await write_setting(ValueSetting, 'G2')\r\n\r\n        console.log(WriteStatus)\r\n        if (WriteStatus[\"success\"] === true) {\r\n            console.log('success')\r\n            RenderNewData()        }\r\n\r\n        else { console.log('fail') }\r\n\r\n        console.log(ValueSetting)\r\n    }\r\n\r\n\r\n    return (\r\n        <div style={{marginTop:'20px'}}>\r\n            <Card title='G2 Notification Setting' bordered={true} style={{ width: '100%', borderRadius: 15, backgroundColor: '#c4c4c4' }}\r\n                bodyStyle={{ backgroundColor: '#575757', borderBottomLeftRadius: 15, borderBottomRightRadius: 15 }} hoverable={true}>\r\n\r\n                <Button onClick={SettingSavehandler} style={{ marginBottom: '8px' }}> Save </Button>\r\n\r\n                <Form form={form} component={false}>\r\n                    <Table\r\n                        components={{\r\n                            body: {\r\n                                cell: EditableCell,\r\n                            },\r\n                        }}\r\n                        bordered\r\n                        scroll={{ x: 500, y: 800 }}\r\n                        dataSource={ValueSetting}\r\n                        columns={mergedColumns}\r\n                        rowClassName=\"editable-row\"\r\n                        pagination={false}\r\n\r\n\r\n                    />\r\n                </Form>\r\n            </Card>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default NotificationG2\r\n"]},"metadata":{},"sourceType":"module"}