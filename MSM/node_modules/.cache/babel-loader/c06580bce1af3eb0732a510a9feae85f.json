{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\tzika\\\\Desktop\\\\Polymerlink-Front\\\\polymerlink-2\\\\src\\\\DataRequest\\\\LogDataRequestWrap.js\";\nimport { Button } from 'antd';\nimport moment from 'moment';\nimport XlsxPopulate from 'xlsx-populate';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const TableColumbTimeAsRow = () => {\n  let Columb = [];\n  let TimeRow = [];\n\n  for (let i = 0; i < 24; i++) {\n    let n;\n    i < 10 ? n = `0${i}` : n = i;\n    TimeRow.push(`${n}:00`);\n  }\n\n  Columb.push({\n    title: 'Parameter',\n    width: 100,\n    dataIndex: 'Parameter',\n    key: 'Parameter',\n    fixed: 'left',\n    align: 'center'\n  });\n  TimeRow.forEach(element => {\n    Columb.push({\n      title: element,\n      width: 70,\n      dataIndex: element,\n      key: element,\n      align: 'center'\n    });\n  });\n  return Columb;\n};\n_c = TableColumbTimeAsRow;\nexport const TableColumbLabelAsRow = Datamodel => {\n  let Columb = [];\n  Columb.push({\n    title: 'Time',\n    width: 60,\n    dataIndex: 'Time',\n    key: 'Time',\n    fixed: 'left',\n    align: 'center'\n  });\n  const name = Object.keys(Datamodel);\n  name.forEach(element => {\n    Columb.push({\n      title: element,\n      width: 70,\n      dataIndex: element,\n      key: element,\n      align: 'center'\n    });\n  }); //console.log(Columb);\n\n  return Columb;\n};\n_c2 = TableColumbLabelAsRow;\nexport const TableColumbJob = (Datamodel, Viewhandler) => {\n  let Columb = [];\n  const name = Object.keys(Datamodel);\n  name.forEach(element => {\n    Columb.push({\n      title: element,\n      width: 70,\n      dataIndex: element,\n      key: element,\n      align: 'center'\n    });\n  });\n  Columb.push({\n    title: 'View',\n    width: 60,\n    dataIndex: 'View',\n    key: 'View',\n    align: 'center',\n    render: (text, record, index) => /*#__PURE__*/_jsxDEV(Button, {\n      onClick: e => {\n        Viewhandler(record);\n      },\n      children: \" Click \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 46\n    }, this)\n  });\n  Columb.push({\n    title: 'Delete',\n    width: 60,\n    dataIndex: 'Delete',\n    key: 'Delete',\n    align: 'center',\n    render: (text, record, index) => /*#__PURE__*/_jsxDEV(Button, {\n      onClick: e => {\n        Viewhandler(record);\n      },\n      children: \" Delete \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 50\n    }, this)\n  }); //console.log(Columb);\n\n  return Columb;\n};\n_c3 = TableColumbJob;\nexport const GetDateTime = OffsetDay => {\n  let DateTimeArray = [];\n  let separator = '-';\n  let today = new Date();\n  let tomorrow = new Date(today);\n  tomorrow.setDate(tomorrow.getDate() + OffsetDay);\n  let date1 = today.getDate();\n  let month1 = today.getMonth() + 1;\n  let year1 = today.getFullYear();\n  let date2 = tomorrow.getDate();\n  let month2 = tomorrow.getMonth() + 1;\n  let year2 = tomorrow.getFullYear();\n  let Start_time = `${year1}${separator}${month1 < 10 ? `0${month1}` : `${month1}`}${separator}${date1} 00:00:00`;\n  let End_time = `${year2}${separator}${month2 < 10 ? `0${month2}` : `${month2}`}${separator}${date2} 00:00:00`;\n  DateTimeArray[0] = moment(Start_time).toISOString(false).split('.')[0] + \"Z\";\n  DateTimeArray[1] = moment(End_time).toISOString(false).split('.')[0] + \"Z\";\n  return DateTimeArray;\n};\n_c4 = GetDateTime;\nexport const SetDateRange = datetime => {\n  let DateTime = [];\n  let ReturnDT = [];\n  DateTime[0] = moment(datetime, \"DD-MM-YYYY\").subtract(1, 'days');\n  DateTime[1] = datetime; //moment(datetime, \"DD-MM-YYYY\").add(1, 'days');\n\n  ReturnDT[0] = DateTime[0].toISOString(false).split('T')[0] + \"T16:00:00Z\";\n  ReturnDT[1] = DateTime[1].toISOString(false).split('T')[0] + \"T15:00:00Z\"; //console.log(ReturnDT)\n\n  return ReturnDT;\n};\n_c5 = SetDateRange;\nexport const ConvertMonentToDateTime = momentDateTime => {\n  let DateTimeReturn = [];\n\n  try {\n    DateTimeReturn[0] = momentDateTime[0].toISOString(false).split('.')[0] + \"Z\";\n    DateTimeReturn[1] = momentDateTime[1].toISOString(false).split('.')[0] + \"Z\";\n  } catch {}\n\n  return DateTimeReturn;\n};\n_c6 = ConvertMonentToDateTime;\nexport const DataSortTime = response => {\n  let DataReturn;\n\n  if (response.success === true) {\n    const data = response.data;\n    DataReturn = data.map(obj => {\n      let cobj = [];\n      let date_new = moment(obj.fields.DateCreated);\n      let DateComponent = date_new.utc(true).format('DD-MM-YYYY HH:mm:ss');\n      let TimeComponent = date_new.utc(true).format('HH:mm:ss');\n      let ar0 = TimeComponent.split(':');\n      let ar1 = ar0[0] + ':' + ar0[1];\n      cobj = {\n        'key': obj.fields.Parameter,\n        'time': ar1,\n        'date': DateComponent,\n        'Parameter': obj.fields.Parameter,\n        'Value': obj.fields.Value\n      };\n      return cobj;\n    }); //console.log(DataReturn);\n  } else {\n    console.log(response);\n  }\n\n  return DataReturn;\n};\n_c7 = DataSortTime;\nexport const ReportSort = response => {\n  let DataReturn;\n\n  if (response.success === true) {\n    const data = response.data;\n    DataReturn = data.map(obj => {\n      let cobj = [];\n      let DateTime_Start = moment(obj.fields.DateTime_Start).utc(true).format('DD-MM-YYYY HH:mm:ss');\n      let DateTime_End = moment(obj.fields.DateTime_End).utc(true).format('DD-MM-YYYY HH:mm:ss'); // let ar0 = TimeComponent.split(':')\n      // let ar1 = ar0[0] + ':' + ar0[1]\n\n      cobj = {\n        'key': obj.fields.Info1,\n        'Start Time': DateTime_Start,\n        'End Time': DateTime_End,\n        'Job No': obj.fields.Info1,\n        'Grade': obj.fields.Info2,\n        'Color': obj.fields.Info3\n      };\n      return cobj;\n    }); //console.log(DataReturn);\n  } else {\n    console.log(response);\n  }\n\n  return DataReturn;\n};\n_c8 = ReportSort;\nexport const LogDataMappingTime = (Datamodel, RawData) => {\n  const name = Object.keys(Datamodel);\n  let ReturnValue = [];\n  let bufferModel = {};\n  bufferModel.Parameter = 0;\n\n  for (let i = 0; i < 24; i++) {\n    let n;\n    i < 10 ? n = `0${i}` : n = i;\n    bufferModel[`${n}:00`] = 0;\n  }\n\n  name.forEach(element => {\n    let Buffer = {};\n    Object.assign(Buffer, bufferModel);\n    Buffer.Parameter = element;\n    RawData.forEach(element2 => {\n      if (element2.Parameter === element) {\n        Buffer[element2.time] = element2.Value;\n        Buffer['key'] = element2.Parameter;\n      }\n    });\n    ReturnValue.push(Buffer);\n  });\n  return ReturnValue;\n};\n_c9 = LogDataMappingTime;\nexport const LogDataMappingName = (Datamodel, RawData) => {\n  const name = Object.keys(Datamodel);\n  let prevtime = [],\n      period = \"\",\n      ReturnValue = [];\n\n  const parasearch = item => {\n    if (item.date === period) {\n      return true;\n    }\n\n    return false;\n  };\n\n  RawData.forEach(element => {\n    if (element.date === prevtime) {} else {\n      prevtime = element.date;\n      period = element.date;\n      let data_buf3 = {};\n      name.forEach(element => {\n        data_buf3[element] = 0;\n      });\n      let data_buf2 = RawData.filter(parasearch);\n      data_buf2.map(obj => {\n        data_buf3['key'] = obj.date;\n        data_buf3['Time'] = obj.date;\n        data_buf3[obj.Parameter] = obj.Value;\n        return data_buf3;\n      });\n      ReturnValue.push(data_buf3);\n    }\n  });\n  return ReturnValue;\n};\n_c10 = LogDataMappingName;\nexport const SortToArrayExcel = (DataJson, DataModel) => {\n  let bufferArray = [];\n  let bufferArray2 = [];\n  const para = Object.keys(DataJson[1]);\n  const name = Object.keys(DataModel);\n  let ReturnPara = {\n    Array: [],\n    height: 1,\n    width: 1\n  };\n  bufferArray.push(DataJson[1]['Time']);\n  DataJson.forEach(element => {\n    let bufferArray = [];\n    bufferArray.push(element['Time']);\n    name.forEach(element1 => {\n      para.forEach(element2 => {\n        let number;\n\n        if (element2 === element1) {\n          try {\n            number = parseFloat(element[element2]);\n          } catch {\n            console.log(element[element2]);\n            number = parseFloat(0);\n          } //console.log(LogValue['LogC3'][1][element2])\n\n\n          bufferArray.push(number);\n        }\n      });\n    });\n    bufferArray2.push(bufferArray);\n  });\n  ReturnPara.Array = bufferArray2;\n  ReturnPara.height = bufferArray2.length;\n  ReturnPara.width = bufferArray2[0].length;\n  console.log(ReturnPara);\n  return ReturnPara;\n};\n_c11 = SortToArrayExcel;\nexport const ExportExcelWorkBook = (DataJson, DataModel, StartingCell, EndingCell, FileName) => {\n  fetch(FileName).then(res => res.arrayBuffer()).then(buffer => {\n    XlsxPopulate.fromDataAsync(buffer).then(workbook => {\n      // r = workbook.sheet(0).cell(\"A8\").value(\"foo\");\n      let setting = SortToArrayExcel(DataJson, DataModel);\n      const r = workbook.sheet(0).range(`${StartingCell}:${EndingCell[0]}${EndingCell[1] + setting.height}`);\n      r.value(setting.Array);\n      workbook.outputAsync().then(function (blob) {\n        if (window.navigator && window.navigator.msSaveOrOpenBlob) {\n          window.navigator.msSaveOrOpenBlob(blob, \"out.xlsx\");\n        } else {\n          var url = window.URL.createObjectURL(blob);\n          var a = document.createElement(\"a\");\n          document.body.appendChild(a);\n          a.href = url;\n          a.download = FileName;\n          a.click();\n          window.URL.revokeObjectURL(url);\n          document.body.removeChild(a);\n        }\n      });\n    }).catch(err => console.error(err));\n  });\n};\n_c12 = ExportExcelWorkBook;\n\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c10, _c11, _c12;\n\n$RefreshReg$(_c, \"TableColumbTimeAsRow\");\n$RefreshReg$(_c2, \"TableColumbLabelAsRow\");\n$RefreshReg$(_c3, \"TableColumbJob\");\n$RefreshReg$(_c4, \"GetDateTime\");\n$RefreshReg$(_c5, \"SetDateRange\");\n$RefreshReg$(_c6, \"ConvertMonentToDateTime\");\n$RefreshReg$(_c7, \"DataSortTime\");\n$RefreshReg$(_c8, \"ReportSort\");\n$RefreshReg$(_c9, \"LogDataMappingTime\");\n$RefreshReg$(_c10, \"LogDataMappingName\");\n$RefreshReg$(_c11, \"SortToArrayExcel\");\n$RefreshReg$(_c12, \"ExportExcelWorkBook\");","map":{"version":3,"sources":["C:/Users/tzika/Desktop/Polymerlink-Front/polymerlink-2/src/DataRequest/LogDataRequestWrap.js"],"names":["Button","moment","XlsxPopulate","TableColumbTimeAsRow","Columb","TimeRow","i","n","push","title","width","dataIndex","key","fixed","align","forEach","element","TableColumbLabelAsRow","Datamodel","name","Object","keys","TableColumbJob","Viewhandler","render","text","record","index","e","GetDateTime","OffsetDay","DateTimeArray","separator","today","Date","tomorrow","setDate","getDate","date1","month1","getMonth","year1","getFullYear","date2","month2","year2","Start_time","End_time","toISOString","split","SetDateRange","datetime","DateTime","ReturnDT","subtract","ConvertMonentToDateTime","momentDateTime","DateTimeReturn","DataSortTime","response","DataReturn","success","data","map","obj","cobj","date_new","fields","DateCreated","DateComponent","utc","format","TimeComponent","ar0","ar1","Parameter","Value","console","log","ReportSort","DateTime_Start","DateTime_End","Info1","Info2","Info3","LogDataMappingTime","RawData","ReturnValue","bufferModel","Buffer","assign","element2","time","LogDataMappingName","prevtime","period","parasearch","item","date","data_buf3","data_buf2","filter","SortToArrayExcel","DataJson","DataModel","bufferArray","bufferArray2","para","ReturnPara","Array","height","element1","number","parseFloat","length","ExportExcelWorkBook","StartingCell","EndingCell","FileName","fetch","then","res","arrayBuffer","buffer","fromDataAsync","workbook","setting","r","sheet","range","value","outputAsync","blob","window","navigator","msSaveOrOpenBlob","url","URL","createObjectURL","a","document","createElement","body","appendChild","href","download","click","revokeObjectURL","removeChild","catch","err","error"],"mappings":"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","sourcesContent":["import { Button } from 'antd';\r\nimport moment from 'moment';\r\nimport XlsxPopulate from 'xlsx-populate'\r\n\r\n\r\nexport const TableColumbTimeAsRow = () => {\r\n    let Columb = []\r\n    let TimeRow = []\r\n\r\n    for (let i = 0; i < 24; i++) {\r\n        let n\r\n        i < 10 ? n = `0${i}` : n = i\r\n        TimeRow.push(`${n}:00`)\r\n    }\r\n\r\n    Columb.push(\r\n        {\r\n            title: 'Parameter',\r\n            width: 100,\r\n            dataIndex: 'Parameter',\r\n            key: 'Parameter',\r\n            fixed: 'left',\r\n            align: 'center',\r\n        })\r\n\r\n    TimeRow.forEach(element => {\r\n        Columb.push(\r\n            {\r\n                title: element,\r\n                width: 70,\r\n                dataIndex: element,\r\n                key: element,\r\n                align: 'center',\r\n            }\r\n        )\r\n    });\r\n    return Columb\r\n}\r\n\r\nexport const TableColumbLabelAsRow = (Datamodel) => {\r\n    let Columb = []\r\n\r\n    Columb.push(\r\n        {\r\n            title: 'Time',\r\n            width: 60,\r\n            dataIndex: 'Time',\r\n            key: 'Time',\r\n            fixed: 'left',\r\n            align: 'center',\r\n        })\r\n\r\n    const name = Object.keys(Datamodel)\r\n    name.forEach(element => {\r\n        Columb.push(\r\n            {\r\n                title: element,\r\n                width: 70,\r\n                dataIndex: element,\r\n                key: element,\r\n                align: 'center',\r\n            }\r\n        )\r\n    })\r\n\r\n    //console.log(Columb);\r\n    return Columb\r\n}\r\n\r\nexport const TableColumbJob = (Datamodel, Viewhandler) => {\r\n    let Columb = []\r\n\r\n    const name = Object.keys(Datamodel)\r\n    name.forEach(element => {\r\n        Columb.push(\r\n            {\r\n                title: element,\r\n                width: 70,\r\n                dataIndex: element,\r\n                key: element,\r\n                align: 'center',\r\n            }\r\n        )\r\n    })\r\n\r\n    Columb.push(\r\n        {\r\n            title: 'View',\r\n            width: 60,\r\n            dataIndex: 'View',\r\n            key: 'View',\r\n            align: 'center',\r\n            render: (text, record, index) => <Button onClick={\r\n                (e) => { Viewhandler(record) }\r\n            } > Click </Button>,\r\n        })\r\n\r\n        Columb.push(\r\n            {\r\n                title: 'Delete',\r\n                width: 60,\r\n                dataIndex: 'Delete',\r\n                key: 'Delete',\r\n                align: 'center',\r\n                render: (text, record, index) => <Button onClick={\r\n                    (e) => { Viewhandler(record) }\r\n                } > Delete </Button>,\r\n            })\r\n\r\n    //console.log(Columb);\r\n    return Columb\r\n}\r\n\r\nexport const GetDateTime = (OffsetDay) => {\r\n\r\n    let DateTimeArray = []\r\n    let separator = '-'\r\n\r\n    let today = new Date()\r\n    let tomorrow = new Date(today)\r\n    tomorrow.setDate(tomorrow.getDate() + OffsetDay)\r\n\r\n    let date1 = today.getDate();\r\n    let month1 = today.getMonth() + 1;\r\n    let year1 = today.getFullYear();\r\n\r\n    let date2 = tomorrow.getDate();\r\n    let month2 = tomorrow.getMonth() + 1;\r\n    let year2 = tomorrow.getFullYear();\r\n\r\n\r\n    let Start_time = `${year1}${separator}${month1 < 10 ? `0${month1}` : `${month1}`}${separator}${date1} 00:00:00`\r\n    let End_time = `${year2}${separator}${month2 < 10 ? `0${month2}` : `${month2}`}${separator}${date2} 00:00:00`\r\n\r\n    DateTimeArray[0] = moment(Start_time).toISOString(false).split('.')[0] + \"Z\"\r\n    DateTimeArray[1] = moment(End_time).toISOString(false).split('.')[0] + \"Z\"\r\n\r\n    return DateTimeArray\r\n}\r\n\r\nexport const SetDateRange = (datetime) => {\r\n    let DateTime = []\r\n    let ReturnDT = []\r\n    DateTime[0] = moment(datetime, \"DD-MM-YYYY\").subtract(1, 'days')\r\n    DateTime[1] = datetime//moment(datetime, \"DD-MM-YYYY\").add(1, 'days');\r\n\r\n    ReturnDT[0] = DateTime[0].toISOString(false).split('T')[0] + \"T16:00:00Z\"\r\n    ReturnDT[1] = DateTime[1].toISOString(false).split('T')[0] + \"T15:00:00Z\"\r\n    //console.log(ReturnDT)\r\n    return ReturnDT\r\n}\r\n\r\nexport const ConvertMonentToDateTime = (momentDateTime) => {\r\n    let DateTimeReturn = []\r\n\r\n    try {\r\n        DateTimeReturn[0] = momentDateTime[0].toISOString(false).split('.')[0] + \"Z\"\r\n        DateTimeReturn[1] = momentDateTime[1].toISOString(false).split('.')[0] + \"Z\"\r\n    }\r\n    catch { }\r\n    return DateTimeReturn\r\n}\r\n\r\nexport const DataSortTime = (response) => {\r\n    let DataReturn\r\n    if (response.success === true) {\r\n        const data = response.data\r\n\r\n        DataReturn = data.map(obj => {\r\n            let cobj = []\r\n            let date_new = moment(obj.fields.DateCreated);\r\n            let DateComponent = date_new.utc(true).format('DD-MM-YYYY HH:mm:ss')\r\n            let TimeComponent = date_new.utc(true).format('HH:mm:ss')\r\n            let ar0 = TimeComponent.split(':')\r\n            let ar1 = ar0[0] + ':' + ar0[1]\r\n\r\n            cobj = {\r\n                'key': obj.fields.Parameter,\r\n                'time': ar1,\r\n                'date': DateComponent,\r\n                'Parameter': obj.fields.Parameter,\r\n                'Value': obj.fields.Value,\r\n            }\r\n            return cobj\r\n        })\r\n        //console.log(DataReturn);\r\n    }\r\n    else {\r\n        console.log(response)\r\n    }\r\n    return DataReturn\r\n}\r\n\r\nexport const ReportSort = (response) => {\r\n    let DataReturn\r\n    if (response.success === true) {\r\n        const data = response.data\r\n\r\n        DataReturn = data.map(obj => {\r\n            let cobj = []\r\n            let DateTime_Start = (moment(obj.fields.DateTime_Start)).utc(true).format('DD-MM-YYYY HH:mm:ss')\r\n            let DateTime_End = (moment(obj.fields.DateTime_End)).utc(true).format('DD-MM-YYYY HH:mm:ss')\r\n            // let ar0 = TimeComponent.split(':')\r\n            // let ar1 = ar0[0] + ':' + ar0[1]\r\n\r\n            cobj = {\r\n                'key': obj.fields.Info1,\r\n                'Start Time': DateTime_Start,\r\n                'End Time': DateTime_End,\r\n                'Job No': obj.fields.Info1,\r\n                'Grade': obj.fields.Info2,\r\n                'Color': obj.fields.Info3,\r\n            }\r\n            return cobj\r\n        })\r\n        //console.log(DataReturn);\r\n    }\r\n    else {\r\n        console.log(response)\r\n    }\r\n    return DataReturn\r\n}\r\n\r\nexport const LogDataMappingTime = (Datamodel, RawData) => {\r\n    const name = Object.keys(Datamodel)\r\n    let ReturnValue = []\r\n    let bufferModel = {}\r\n    bufferModel.Parameter = 0\r\n\r\n    for (let i = 0; i < 24; i++) {\r\n        let n\r\n        i < 10 ? n = `0${i}` : n = i\r\n        bufferModel[`${n}:00`] = 0\r\n    }\r\n\r\n    name.forEach(element => {\r\n        let Buffer = {}\r\n        Object.assign(Buffer, bufferModel)\r\n        Buffer.Parameter = element\r\n\r\n        RawData.forEach(element2 => {\r\n            if (element2.Parameter === element) {\r\n                Buffer[element2.time] = element2.Value\r\n                Buffer['key'] = element2.Parameter\r\n            }\r\n        })\r\n        ReturnValue.push(Buffer)\r\n    })\r\n    return ReturnValue\r\n}\r\n\r\n\r\nexport const LogDataMappingName = (Datamodel, RawData) => {\r\n    const name = Object.keys(Datamodel)\r\n\r\n\r\n    let prevtime = [], period = \"\", ReturnValue = []\r\n\r\n    const parasearch = (item) => {\r\n        if (item.date === period) { return true; }\r\n        return false\r\n    }\r\n\r\n    RawData.forEach(element => {\r\n        if (element.date === prevtime) { }\r\n\r\n        else {\r\n            prevtime = element.date\r\n            period = element.date\r\n\r\n            let data_buf3 = {}\r\n\r\n            name.forEach(element => {\r\n                data_buf3[element] = 0\r\n            });\r\n\r\n            let data_buf2 = RawData.filter(parasearch)\r\n\r\n            data_buf2.map(obj => {\r\n                data_buf3['key'] = obj.date\r\n                data_buf3['Time'] = obj.date\r\n                data_buf3[obj.Parameter] = obj.Value\r\n                return data_buf3\r\n            })\r\n            ReturnValue.push(data_buf3)\r\n        }\r\n    })\r\n    return ReturnValue\r\n}\r\n\r\n\r\nexport const SortToArrayExcel = (DataJson, DataModel) => {\r\n\r\n    let bufferArray = []\r\n    let bufferArray2 = []\r\n    const para = Object.keys(DataJson[1])\r\n    const name = Object.keys(DataModel)\r\n    let ReturnPara = {\r\n        Array: [],\r\n        height: 1,\r\n        width: 1\r\n    }\r\n    bufferArray.push(DataJson[1]['Time'])\r\n\r\n    DataJson.forEach(element => {\r\n        let bufferArray = []\r\n        bufferArray.push(element['Time'])\r\n\r\n        name.forEach(element1 => {\r\n\r\n            para.forEach(element2 => {\r\n                let number\r\n\r\n                if (element2 === element1) {\r\n                    try {\r\n                        number = parseFloat(element[element2])\r\n                    }\r\n                    catch {\r\n                        console.log(element[element2]);\r\n                        number = parseFloat(0)\r\n                     }  \r\n\r\n                    //console.log(LogValue['LogC3'][1][element2])\r\n                    bufferArray.push(number)\r\n                }\r\n            })\r\n\r\n        })\r\n        bufferArray2.push(bufferArray)\r\n    });\r\n\r\n    ReturnPara.Array = bufferArray2\r\n    ReturnPara.height = bufferArray2.length\r\n    ReturnPara.width = bufferArray2[0].length\r\n    console.log(ReturnPara)\r\n\r\n    return ReturnPara\r\n}\r\n\r\n\r\nexport const ExportExcelWorkBook = ( DataJson, DataModel, StartingCell, EndingCell, FileName ) => {\r\n\r\n    fetch(FileName)\r\n        .then(res => res.arrayBuffer())\r\n        .then(buffer => {\r\n            XlsxPopulate.fromDataAsync(buffer)\r\n                .then(workbook => {\r\n\r\n                    // r = workbook.sheet(0).cell(\"A8\").value(\"foo\");\r\n                    let setting = SortToArrayExcel(DataJson,DataModel)\r\n\r\n                    const r = workbook.sheet(0).range(`${StartingCell}:${EndingCell[0]}${EndingCell[1] + setting.height}`);\r\n\r\n                    r.value(setting.Array);\r\n\r\n                    workbook.outputAsync()\r\n                        .then(function (blob) {\r\n                            if (window.navigator && window.navigator.msSaveOrOpenBlob) {\r\n                                window.navigator.msSaveOrOpenBlob(blob, \"out.xlsx\");\r\n                            } \r\n                            \r\n                            else {\r\n                                var url = window.URL.createObjectURL(blob);\r\n                                var a = document.createElement(\"a\");\r\n                                document.body.appendChild(a);\r\n                                a.href = url;\r\n                                a.download = FileName;\r\n                                a.click();\r\n                                window.URL.revokeObjectURL(url);\r\n                                document.body.removeChild(a);\r\n                            }\r\n                        });\r\n                })\r\n                .catch(err => console.error(err));\r\n        })\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}