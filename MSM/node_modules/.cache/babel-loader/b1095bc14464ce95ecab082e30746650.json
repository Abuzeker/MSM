{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/tzika/Desktop/Polymerlink-Front/polymerlink-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/tzika/Desktop/Polymerlink-Front/polymerlink-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:/Users/tzika/Desktop/Polymerlink-Front/polymerlink-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/tzika/Desktop/Polymerlink-Front/polymerlink-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/tzika/Desktop/Polymerlink-Front/polymerlink-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/tzika/Desktop/Polymerlink-Front/polymerlink-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import{Form,Input,Button,Checkbox,Card,message}from'antd';import'./Login.css';import logo from'../../assets/poly2.png';import memoryUtils from'../../utils/memoryUtils';import storageUtils from'../../utils/storageUtils';import{Redirect}from\"react-router-dom\";import React,{Component}from'react';import{LoginBackend}from'../../api/index';// const result = {\n//     status: 0,\n//     data: 'tan',\n//     msg: 'salah pass lah!'\n// }\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var Login=/*#__PURE__*/function(_Component){_inherits(Login,_Component);var _super=_createSuper(Login);function Login(){var _this;_classCallCheck(this,Login);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.onFinish=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(values){var username,password,result,user;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:username=values.username,password=values.password;_context.next=3;return LoginBackend(username,password);case 3:result=_context.sent;if(result.expiry!==null){//success\n// save user info to local\nuser={name:username,site:'All',role:'Operator',autolevel:2};memoryUtils.user=user;storageUtils.saveUser(user);message.success('Login Success');_this.props.history.replace('/');}else{//wrong pass or name\nmessage.error(result.msg);}case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.onFinishFailed=function(errorInfo){console.log('Failed:',errorInfo);};return _this;}_createClass(Login,[{key:\"render\",value:function render(){var user=memoryUtils.user;if(Object.keys(user).length!==0){console.log('smtg');console.log(Object.keys(user).length);return/*#__PURE__*/_jsx(Redirect,{push:true,to:\"/\"});// return <Redirect to='/' />\n}else{console.log('ntg');console.log(Object.keys(user).length);}return/*#__PURE__*/_jsxs(\"div\",{className:\"login\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"login-header\",children:[/*#__PURE__*/_jsx(\"img\",{src:logo,alt:\"logo\"}),/*#__PURE__*/_jsx(\"h1\",{children:\"PLM-IOT\"})]}),/*#__PURE__*/_jsx(Card,{className:\"login-content\",children:/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Login\"}),/*#__PURE__*/_jsxs(Form,{name:\"basic\",labelCol:{span:8},wrapperCol:{span:16},initialValues:{remember:true},onFinish:this.onFinish,onFinishFailed:this.onFinishFailed,autoComplete:\"off\",className:\"login-form\",children:[/*#__PURE__*/_jsx(Form.Item,{label:\"Username\",name:\"username\",rules:[{required:true,message:'Please input your username!'}],children:/*#__PURE__*/_jsx(Input,{})}),/*#__PURE__*/_jsx(Form.Item,{label:\"Password\",name:\"password\",rules:[{required:true,message:'Please input your password!'}],children:/*#__PURE__*/_jsx(Input.Password,{})}),/*#__PURE__*/_jsx(Form.Item,{wrapperCol:{offset:8,span:16},children:/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"submit\",children:\"Login\"})})]})]})})]});}}]);return Login;}(Component);export default Login;","map":{"version":3,"sources":["C:/Users/tzika/Desktop/Polymerlink-Front/polymerlink-2/src/pages/Login/Login.jsx"],"names":["Form","Input","Button","Checkbox","Card","message","logo","memoryUtils","storageUtils","Redirect","React","Component","LoginBackend","Login","onFinish","values","username","password","result","expiry","user","name","site","role","autolevel","saveUser","success","props","history","replace","error","msg","onFinishFailed","errorInfo","console","log","Object","keys","length","span","remember","required","offset"],"mappings":"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","sourcesContent":["import { Form, Input, Button, Checkbox, Card, message } from 'antd';\r\nimport './Login.css'\r\nimport logo from '../../assets/poly2.png'\r\nimport memoryUtils from '../../utils/memoryUtils'\r\nimport storageUtils from '../../utils/storageUtils'\r\nimport { Redirect} from \"react-router-dom\"\r\nimport React, { Component } from 'react'\r\nimport { LoginBackend } from '../../api/index'\r\n\r\n// const result = {\r\n//     status: 0,\r\n//     data: 'tan',\r\n//     msg: 'salah pass lah!'\r\n// }\r\n\r\nexport class Login extends Component {\r\n\r\n    onFinish = async (values) => {\r\n\r\n        const { username, password } = values\r\n\r\n        const result = await LoginBackend(username, password)\r\n\r\n        if (result.expiry !== null) { //success\r\n\r\n            // save user info to local\r\n            const user = {\r\n                name: username,\r\n                site: 'All',\r\n                role: 'Operator',\r\n                autolevel: 2\r\n            }\r\n            memoryUtils.user = user\r\n            storageUtils.saveUser(user)\r\n            message.success('Login Success')\r\n            this.props.history.replace('/')\r\n        }\r\n\r\n        else { //wrong pass or name\r\n            message.error(result.msg)\r\n        }\r\n\r\n    };\r\n\r\n    onFinishFailed = (errorInfo) => {\r\n        console.log('Failed:', errorInfo);\r\n    };\r\n\r\n    render() {\r\n        const user = memoryUtils.user\r\n        if (Object.keys(user).length !== 0) {\r\n            console.log('smtg')\r\n            console.log(Object.keys(user).length)\r\n\r\n            return <Redirect push to=\"/\" />\r\n            // return <Redirect to='/' />\r\n        }\r\n        else {\r\n            console.log('ntg')\r\n            console.log(Object.keys(user).length)\r\n        }\r\n\r\n        return (\r\n            <div className='login'>\r\n\r\n                <header className=\"login-header\">\r\n                    <img src={logo} alt=\"logo\" />\r\n                    <h1>PLM-IOT</h1>\r\n                </header>\r\n\r\n                <Card className=\"login-content\">\r\n\r\n                    <section >\r\n                        <h2>Login</h2>\r\n\r\n                        <Form\r\n                            name=\"basic\"\r\n                            labelCol={{\r\n                                span: 8,\r\n                            }}\r\n                            wrapperCol={{\r\n                                span: 16,\r\n                            }}\r\n                            initialValues={{\r\n                                remember: true,\r\n                            }}\r\n                            onFinish={this.onFinish}\r\n                            onFinishFailed={this.onFinishFailed}\r\n                            autoComplete=\"off\"\r\n                            className=\"login-form\"\r\n                        >\r\n                            <Form.Item\r\n                                label=\"Username\"\r\n                                name=\"username\"\r\n                                rules={[\r\n                                    {\r\n                                        required: true,\r\n                                        message: 'Please input your username!',\r\n                                    },\r\n                                ]}\r\n                            >\r\n                                <Input />\r\n                            </Form.Item>\r\n\r\n                            <Form.Item\r\n                                label=\"Password\"\r\n                                name=\"password\"\r\n                                rules={[\r\n                                    {\r\n                                        required: true,\r\n                                        message: 'Please input your password!',\r\n                                    },\r\n                                ]}\r\n                            >\r\n                                <Input.Password />\r\n                            </Form.Item>\r\n\r\n                            <Form.Item\r\n                                wrapperCol={{\r\n                                    offset: 8,\r\n                                    span: 16,\r\n                                }}\r\n                            >\r\n                                <Button type=\"primary\" htmlType=\"submit\">\r\n                                    Login\r\n                                </Button>\r\n                            </Form.Item>\r\n                        </Form>\r\n                    </section>\r\n                </Card>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default Login\r\n"]},"metadata":{},"sourceType":"module"}