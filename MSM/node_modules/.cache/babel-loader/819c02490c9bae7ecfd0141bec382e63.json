{"ast":null,"code":"\"use strict\"; // V8 doesn't support optimization for compound assignment of let variables.\n// These methods get called a lot so disable the rule to allow V8 opmtimization.\n\n/* eslint-disable operator-assignment */\n\nconst _ = require(\"lodash\");\n\nconst ADDRESS_REGEX = /^(?:'?(.+?)'?!)?(?:(\\$)?([A-Z]+)(\\$)?(\\d+)(?::(\\$)?([A-Z]+)(\\$)?(\\d+))?|(\\$)?([A-Z]+):(\\$)?([A-Z]+)|(\\$)?(\\d+):(\\$)?(\\d+))$/;\n/**\n * Address converter.\n * @private\n */\n\nmodule.exports = {\n  /**\n   * Convert a column name to a number.\n   * @param {string} name - The column name.\n   * @returns {number} The number.\n   */\n  columnNameToNumber(name) {\n    if (!name || typeof name !== \"string\") return;\n    name = name.toUpperCase();\n    let sum = 0;\n\n    for (let i = 0; i < name.length; i++) {\n      sum = sum * 26;\n      sum = sum + (name[i].charCodeAt(0) - 'A'.charCodeAt(0) + 1);\n    }\n\n    return sum;\n  },\n\n  /**\n   * Convert a column number to a name.\n   * @param {number} number - The column number.\n   * @returns {string} The name.\n   */\n  columnNumberToName(number) {\n    let dividend = number;\n    let name = '';\n    let modulo = 0;\n\n    while (dividend > 0) {\n      modulo = (dividend - 1) % 26;\n      name = String.fromCharCode('A'.charCodeAt(0) + modulo) + name;\n      dividend = Math.floor((dividend - modulo) / 26);\n    }\n\n    return name;\n  },\n\n  /**\n   * Convert an address to a reference object.\n   * @param {string} address - The address.\n   * @returns {{}} The reference object.\n   */\n  fromAddress(address) {\n    const match = address.match(ADDRESS_REGEX);\n    if (!match) return;\n    const ref = {};\n    if (match[1]) ref.sheetName = match[1].replace(/''/g, \"'\");\n\n    if (match[3] && match[7]) {\n      ref.type = 'range';\n      ref.startColumnAnchored = !!match[2];\n      ref.startColumnName = match[3];\n      ref.startColumnNumber = this.columnNameToNumber(ref.startColumnName);\n      ref.startRowAnchored = !!match[4];\n      ref.startRowNumber = parseInt(match[5]);\n      ref.endColumnAnchored = !!match[6];\n      ref.endColumnName = match[7];\n      ref.endColumnNumber = this.columnNameToNumber(ref.endColumnName);\n      ref.endRowAnchored = !!match[8];\n      ref.endRowNumber = parseInt(match[9]);\n    } else if (match[3]) {\n      ref.type = 'cell';\n      ref.columnAnchored = !!match[2];\n      ref.columnName = match[3];\n      ref.columnNumber = this.columnNameToNumber(ref.columnName);\n      ref.rowAnchored = !!match[4];\n      ref.rowNumber = parseInt(match[5]);\n    } else if (match[11] && match[11] !== match[13]) {\n      ref.type = 'columnRange';\n      ref.startColumnAnchored = !!match[10];\n      ref.startColumnName = match[11];\n      ref.startColumnNumber = this.columnNameToNumber(ref.startColumnName);\n      ref.endColumnAnchored = !!match[12];\n      ref.endColumnName = match[13];\n      ref.endColumnNumber = this.columnNameToNumber(ref.endColumnName);\n    } else if (match[11]) {\n      ref.type = 'column';\n      ref.columnAnchored = !!match[10];\n      ref.columnName = match[11];\n      ref.columnNumber = this.columnNameToNumber(ref.columnName);\n    } else if (match[15] && match[15] !== match[17]) {\n      ref.type = 'rowRange';\n      ref.startRowAnchored = !!match[14];\n      ref.startRowNumber = parseInt(match[15]);\n      ref.endRowAnchored = !!match[16];\n      ref.endRowNumber = parseInt(match[17]);\n    } else if (match[15]) {\n      ref.type = 'row';\n      ref.rowAnchored = !!match[14];\n      ref.rowNumber = parseInt(match[15]);\n    }\n\n    return ref;\n  },\n\n  /**\n   * Convert a reference object to an address.\n   * @param {{}} ref - The reference object.\n   * @returns {string} The address.\n   */\n  toAddress(ref) {\n    let a, b;\n    const sheetName = ref.sheetName;\n\n    if (ref.type === 'cell') {\n      a = {\n        columnName: ref.columnName,\n        columnNumber: ref.columnNumber,\n        columnAnchored: ref.columnAnchored,\n        rowNumber: ref.rowNumber,\n        rowAnchored: ref.rowAnchored\n      };\n    } else if (ref.type === 'range') {\n      a = {\n        columnName: ref.startColumnName,\n        columnNumber: ref.startColumnNumber,\n        columnAnchored: ref.startColumnAnchored,\n        rowNumber: ref.startRowNumber,\n        rowAnchored: ref.startRowAnchored\n      };\n      b = {\n        columnName: ref.endColumnName,\n        columnNumber: ref.endColumnNumber,\n        columnAnchored: ref.endColumnAnchored,\n        rowNumber: ref.endRowNumber,\n        rowAnchored: ref.endRowAnchored\n      };\n    } else if (ref.type === 'column') {\n      a = b = {\n        columnName: ref.columnName,\n        columnNumber: ref.columnNumber,\n        columnAnchored: ref.columnAnchored\n      };\n    } else if (ref.type === 'row') {\n      a = b = {\n        rowNumber: ref.rowNumber,\n        rowAnchored: ref.rowAnchored\n      };\n    } else if (ref.type === 'columnRange') {\n      a = {\n        columnName: ref.startColumnName,\n        columnNumber: ref.startColumnNumber,\n        columnAnchored: ref.startColumnAnchored\n      };\n      b = {\n        columnName: ref.endColumnName,\n        columnNumber: ref.endColumnNumber,\n        columnAnchored: ref.endColumnAnchored\n      };\n    } else if (ref.type === 'rowRange') {\n      a = {\n        rowNumber: ref.startRowNumber,\n        rowAnchored: ref.startRowAnchored\n      };\n      b = {\n        rowNumber: ref.endRowNumber,\n        rowAnchored: ref.endRowAnchored\n      };\n    }\n\n    let address = '';\n    if (sheetName) address = `${address}'${sheetName.replace(/'/g, \"''\")}'!`;\n    if (a.columnAnchored) address = `${address}$`;\n    if (a.columnName) address = address + a.columnName;else if (a.columnNumber) address = address + this.columnNumberToName(a.columnNumber);\n    if (a.rowAnchored) address = `${address}$`;\n    if (a.rowNumber) address = address + a.rowNumber;\n\n    if (b) {\n      address = `${address}:`;\n      if (b.columnAnchored) address = `${address}$`;\n      if (b.columnName) address = address + b.columnName;else if (b.columnNumber) address = address + this.columnNumberToName(b.columnNumber);\n      if (b.rowAnchored) address = `${address}$`;\n      if (b.rowNumber) address = address + b.rowNumber;\n    }\n\n    return address;\n  }\n\n};","map":{"version":3,"sources":["C:/Users/tatac/Desktop/MSM-Front/MSM/node_modules/xlsx-populate/lib/addressConverter.js"],"names":["_","require","ADDRESS_REGEX","module","exports","columnNameToNumber","name","toUpperCase","sum","i","length","charCodeAt","columnNumberToName","number","dividend","modulo","String","fromCharCode","Math","floor","fromAddress","address","match","ref","sheetName","replace","type","startColumnAnchored","startColumnName","startColumnNumber","startRowAnchored","startRowNumber","parseInt","endColumnAnchored","endColumnName","endColumnNumber","endRowAnchored","endRowNumber","columnAnchored","columnName","columnNumber","rowAnchored","rowNumber","toAddress","a","b"],"mappings":"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","sourcesContent":["\"use strict\";\n\n// V8 doesn't support optimization for compound assignment of let variables.\n// These methods get called a lot so disable the rule to allow V8 opmtimization.\n/* eslint-disable operator-assignment */\n\nconst _ = require(\"lodash\");\nconst ADDRESS_REGEX = /^(?:'?(.+?)'?!)?(?:(\\$)?([A-Z]+)(\\$)?(\\d+)(?::(\\$)?([A-Z]+)(\\$)?(\\d+))?|(\\$)?([A-Z]+):(\\$)?([A-Z]+)|(\\$)?(\\d+):(\\$)?(\\d+))$/;\n\n/**\n * Address converter.\n * @private\n */\nmodule.exports = {\n    /**\n     * Convert a column name to a number.\n     * @param {string} name - The column name.\n     * @returns {number} The number.\n     */\n    columnNameToNumber(name) {\n        if (!name || typeof name !== \"string\") return;\n\n        name = name.toUpperCase();\n        let sum = 0;\n        for (let i = 0; i < name.length; i++) {\n            sum = sum * 26;\n            sum = sum + (name[i].charCodeAt(0) - 'A'.charCodeAt(0) + 1);\n        }\n\n        return sum;\n    },\n\n    /**\n     * Convert a column number to a name.\n     * @param {number} number - The column number.\n     * @returns {string} The name.\n     */\n    columnNumberToName(number) {\n        let dividend = number;\n        let name = '';\n        let modulo = 0;\n\n        while (dividend > 0) {\n            modulo = (dividend - 1) % 26;\n            name = String.fromCharCode('A'.charCodeAt(0) + modulo) + name;\n            dividend = Math.floor((dividend - modulo) / 26);\n        }\n\n        return name;\n    },\n\n    /**\n     * Convert an address to a reference object.\n     * @param {string} address - The address.\n     * @returns {{}} The reference object.\n     */\n    fromAddress(address) {\n        const match = address.match(ADDRESS_REGEX);\n        if (!match) return;\n        const ref = {};\n\n        if (match[1]) ref.sheetName = match[1].replace(/''/g, \"'\");\n        if (match[3] && match[7]) {\n            ref.type = 'range';\n            ref.startColumnAnchored = !!match[2];\n            ref.startColumnName = match[3];\n            ref.startColumnNumber = this.columnNameToNumber(ref.startColumnName);\n            ref.startRowAnchored = !!match[4];\n            ref.startRowNumber = parseInt(match[5]);\n            ref.endColumnAnchored = !!match[6];\n            ref.endColumnName = match[7];\n            ref.endColumnNumber = this.columnNameToNumber(ref.endColumnName);\n            ref.endRowAnchored = !!match[8];\n            ref.endRowNumber = parseInt(match[9]);\n        } else if (match[3]) {\n            ref.type = 'cell';\n            ref.columnAnchored = !!match[2];\n            ref.columnName = match[3];\n            ref.columnNumber = this.columnNameToNumber(ref.columnName);\n            ref.rowAnchored = !!match[4];\n            ref.rowNumber = parseInt(match[5]);\n        } else if (match[11] && match[11] !== match[13]) {\n            ref.type = 'columnRange';\n            ref.startColumnAnchored = !!match[10];\n            ref.startColumnName = match[11];\n            ref.startColumnNumber = this.columnNameToNumber(ref.startColumnName);\n            ref.endColumnAnchored = !!match[12];\n            ref.endColumnName = match[13];\n            ref.endColumnNumber = this.columnNameToNumber(ref.endColumnName);\n        } else if (match[11]) {\n            ref.type = 'column';\n            ref.columnAnchored = !!match[10];\n            ref.columnName = match[11];\n            ref.columnNumber = this.columnNameToNumber(ref.columnName);\n        } else if (match[15] && match[15] !== match[17]) {\n            ref.type = 'rowRange';\n            ref.startRowAnchored = !!match[14];\n            ref.startRowNumber = parseInt(match[15]);\n            ref.endRowAnchored = !!match[16];\n            ref.endRowNumber = parseInt(match[17]);\n        } else if (match[15]) {\n            ref.type = 'row';\n            ref.rowAnchored = !!match[14];\n            ref.rowNumber = parseInt(match[15]);\n        }\n\n        return ref;\n    },\n\n    /**\n     * Convert a reference object to an address.\n     * @param {{}} ref - The reference object.\n     * @returns {string} The address.\n     */\n    toAddress(ref) {\n        let a, b;\n        const sheetName = ref.sheetName;\n\n        if (ref.type === 'cell') {\n            a = {\n                columnName: ref.columnName,\n                columnNumber: ref.columnNumber,\n                columnAnchored: ref.columnAnchored,\n                rowNumber: ref.rowNumber,\n                rowAnchored: ref.rowAnchored\n            };\n        } else if (ref.type === 'range') {\n            a = {\n                columnName: ref.startColumnName,\n                columnNumber: ref.startColumnNumber,\n                columnAnchored: ref.startColumnAnchored,\n                rowNumber: ref.startRowNumber,\n                rowAnchored: ref.startRowAnchored\n            };\n            b = {\n                columnName: ref.endColumnName,\n                columnNumber: ref.endColumnNumber,\n                columnAnchored: ref.endColumnAnchored,\n                rowNumber: ref.endRowNumber,\n                rowAnchored: ref.endRowAnchored\n            };\n        } else if (ref.type === 'column') {\n            a = b = {\n                columnName: ref.columnName,\n                columnNumber: ref.columnNumber,\n                columnAnchored: ref.columnAnchored\n            };\n        } else if (ref.type === 'row') {\n            a = b = {\n                rowNumber: ref.rowNumber,\n                rowAnchored: ref.rowAnchored\n            };\n        } else if (ref.type === 'columnRange') {\n            a = {\n                columnName: ref.startColumnName,\n                columnNumber: ref.startColumnNumber,\n                columnAnchored: ref.startColumnAnchored\n            };\n            b = {\n                columnName: ref.endColumnName,\n                columnNumber: ref.endColumnNumber,\n                columnAnchored: ref.endColumnAnchored\n            };\n        } else if (ref.type === 'rowRange') {\n            a = {\n                rowNumber: ref.startRowNumber,\n                rowAnchored: ref.startRowAnchored\n            };\n            b = {\n                rowNumber: ref.endRowNumber,\n                rowAnchored: ref.endRowAnchored\n            };\n        }\n\n        let address = '';\n        if (sheetName) address = `${address}'${sheetName.replace(/'/g, \"''\")}'!`;\n        if (a.columnAnchored) address = `${address}$`;\n        if (a.columnName) address = address + a.columnName;\n        else if (a.columnNumber) address = address + this.columnNumberToName(a.columnNumber);\n        if (a.rowAnchored) address = `${address}$`;\n        if (a.rowNumber) address = address + a.rowNumber;\n\n        if (b) {\n            address = `${address}:`;\n            if (b.columnAnchored) address = `${address}$`;\n            if (b.columnName) address = address + b.columnName;\n            else if (b.columnNumber) address = address + this.columnNumberToName(b.columnNumber);\n            if (b.rowAnchored) address = `${address}$`;\n            if (b.rowNumber) address = address + b.rowNumber;\n        }\n\n        return address;\n    }\n};\n"]},"metadata":{},"sourceType":"script"}